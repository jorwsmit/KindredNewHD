<apex:page controller="SALES_LaunchpadController" sidebar="false" standardStylesheets="false" docType="html-5.0" language="en-US" applyHTMLTag="true" showHeader="false">
<head>
  <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/bootstrap-sortable/2.0.0/bootstrap-sortable.min.css"/>



  <style>
  .just-padding {
    padding: 10px;
  }

  .table > tbody > tr > td{
    border-right: 1px solid #ddd;
  }

  .table > thead > tr > th:last-of-type {
    border-right: 0px;
  }

  .table > tbody > tr > td:last-of-type {
    border-right: 0px;
  }

  .panel-body {
    padding: 0;
  }
  .panel-body > .table{margin-bottom:0px;}

  #centerText {
    width: 100%;
    height: 40px;
    position: absolute;
    top: 50%;
    left: 0;
    margin-top: -10px;
    line-height:19px;
    text-align: center;
  }

  .centerme {
    margin: 0 auto;
    width: 85%;
  }

  .appLink {
    border-radius: 5px;
    background: #428bca;
    padding-right: 10px;
    padding-left: 10px;
    padding-top: 5px;
    margin-bottom: 10px;
    width: 100%;
    height: 100px;
    cursor: pointer;
  }

  .appLink:hover {
    border-radius: 5px;
    background: #3b7db5;
    padding-right: 10px;
    padding-left: 10px;
    padding-top: 5px;
    margin-bottom: 10px;
    width: 100%;
    height: 100px;
    cursor: pointer;
  }

  .closeButton {
    border-radius: 5px;
    background: #d9534f;
    padding-left: 15px;
    padding-top: 5px;
    width: 100px;
    height: 100px;
    cursor: pointer;
  }

  .closeButton:hover {
    border-radius: 5px;
    background: #c34a47;
    padding-left: 15px;
    padding-top: 5px;
    width: 100px;
    height: 100px;
    cursor: pointer;
  }

  .squareButton {
    border-radius: 5px;
    background: #428bca;
    padding-left: 10px;
    padding-top: 5px;
    width: 100px;
    height: 100px;
    cursor: pointer;
  }

  .squareButton:hover {
    border-radius: 5px;
    background: #3b7db5;
    padding-left: 10px;
    padding-top: 5px;
    width: 100px;
    height: 100px;
    cursor: pointer;
  }

  .emailButton {
    border-radius: 5px;
    background: white;
    color: #428bca;
    padding: 0px;
    padding-bottom: 4px;
    width: 20px;
    height: 20px;
    border: 0;
    margin-left: 10px;
  }

  .emailButton:hover {
    border-radius: 5px;
    background: #e6e6e6;
    color: #428bca;
    padding: 0px;
    padding-bottom: 4px;
    width: 20px;
    height: 20px;
    border: 0;
    margin-left: 10px;
  }

  .horizon {
    border-radius: 20px;
    background-color: #F1A636;
    color: white;
    width: 30px;
    margin-left: 10px;
    padding-top:1px;
    padding-bottom:1px;
    padding-left:4px;
    padding-right:4px;
    height: 20px;
  }

  .unity {
    border-radius: 20px;
    background-color: #5cb85c;
    color: white;
    width: 30px;
    margin-left: 10px;
    padding-top:1px;
    padding-bottom:1px;
    padding-left:4px;
    padding-right:4px;
    height: 20px;
  }

  </style>
</head>
<div id="page" class="just-padding">
  <div class="row" id="managerDrilldownButton" style="display: none;">
    <div class="col-xs-12 col-sm-6 col-md-4">
      <div style="padding-bottom:10px;">
        <button type="button" class="btn btn-success" data-toggle="modal" data-target="#managerDrilldownModal" style="width:100%; height:30px; text-align:left;" onclick="getRoles(currentRole);"><i class="fa fa-users" aria-hidden="true"></i><b id="managerDrilldown"> Manager Drilldown</b><span class="pull-right"><i class="fa fa-chevron-circle-down" id="drilldownSpinner"></i></span></button>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-xs-4 col-sm-2 col-md-2" style="display: none;" id="goBackButton">
      <div class="closeButton" onclick="goBack()">
        <i class="fa fa-arrow-left fa-4x" aria-hidden="true" style="color: white;"></i>
        <h4 style="color: white;">Go Back</h4>
      </div>
    </div>

    <div class="col-xs-4 col-sm-2 col-md-2" style="display: none;" id="lastLoginBackButton">
      <div class="closeButton" onclick="lastLoginGoBack()">
        <i class="fa fa-arrow-left fa-4x" aria-hidden="true" style="color: white;"></i>
        <h4 style="color: white;">Go Back</h4>
      </div>
    </div>

    <div id="SPButtons" style="display: none;">
      <div class="col-xs-4 col-sm-2 col-md-2">
        <div class="squareButton" onclick="dateIterate(-1); SPData();">
          <i class="fa fa-arrow-circle-left fa-4x" aria-hidden="true" style="padding-left:14px; color: white;"></i>
          <h5 style="color: white; margin-top:-0.5px; padding-left:15px">Previous<br></br>Month</h5>
        </div>
      </div>
      <div class="col-xs-4 col-sm-2 col-md-2">
        <div class="squareButton" onclick="dateIterate(+1); SPData();">
          <i class="fa fa-arrow-circle-right fa-4x" aria-hidden="true" style="padding-left:14px; color: white;"></i>
          <h5 style="color: white; margin-top:-0.5px; padding-left:15px">Next<br></br>Month</h5>
        </div>
      </div>

    </div>
    <div class="col-xs-4 col-sm-2 col-md-2" style="display: none;" id="newEventButton">
      <div class="squareButton" onclick="navigateTo('null', 'createEvent');">
        <i class="fa fa-plus-square fa-2x" aria-hidden="true" style="color: white; size: 30px;"></i>
        <h5 style="color: white;">New<br></br>Event</h5>
      </div>
    </div>
    <div class="col-xs-4 col-sm-2 col-md-2" style="display: none;" id="goToCalendar">
      <div class="squareButton" onclick="navigateTo('null', 'calendar');">
        <i class="fa fa-calendar fa-2x" aria-hidden="true" style="color: white;"></i>
        <h5 style="color: white;">Go To Calendar</h5>
      </div>
    </div>

    <div id="weekButtons" style="display: none; padding-top:110px;">
      <div class="col-xs-4 col-sm-2 col-md-2">
        <div class="squareButton" onclick="toggleAccountsContacts();" style="height:40px; width:100px;">
          <h5 style="color: white; margin-top:-3px; margin-left:-5px; font-size:15px;" id="toggleAccountsContacts"><span class="pull-left" style="margin-top:2px; padding-right:5px;"><i class="fa fa-building fa-2x" aria-hidden="true"></i></span>View<br/>Account</h5>
        </div>
      </div>
      <div class="col-xs-4 col-sm-2 col-md-2">
        <div class="squareButton" onclick="weekIterate(-1); getThisWeeksEvents();" style="height:40px; width:100px;">
          <h5 style="color: white; margin-top:-3px; margin-left:-5px; font-size:15px;"><span class="pull-left" style="margin-top:2px; padding-right:5px;"><i class="fa fa-arrow-circle-left fa-2x" aria-hidden="true"></i></span>Previous<br/>Week</h5>
        </div>
      </div>
      <div class="col-xs-4 col-sm-2 col-md-2">
        <div class="squareButton" onclick="weekIterate(+1); getThisWeeksEvents();" style="height:40px; width:100px;">
          <h5 style="color: white; margin-top:-3px; font-size:15px;">Next<span class="pull-right" style="margin-top:2px; padding-right:5px;"><i class="fa fa-arrow-circle-right fa-2x" aria-hidden="true"></i></span><br/>Week</h5>
        </div>
      </div>
    </div>
    <div class="col-xs-4 col-sm-2 col-md-2" style="display: none; padding-left: 0px;" id="lastActivityButtons">
      <div class="dropdown" style="padding-left:8px; padding-bottom:6px;">
        <button class="btn btn-primary btn-lg dropdown-toggle" type="button" data-toggle="dropdown" style="padding: 5px; width:125px; text-align: left;"><h3 class="panel-title"><b>Alfa</b><span class="pull-right" id="alfaClassSpan"><i class="fa fa-chevron-circle-down" aria-hidden="true" id="alfaClass"></i></span></h3></button>
        <ul class="dropdown-menu" style="width:225px;">
          <li><a style="cursor: pointer;" onclick="alfaClassification='A+'; $('#alfaClass').removeClass().addClass('fa fa-refresh fa-spin fa-1x fa-fw');">A+</a></li>
          <li><a style="cursor: pointer;" onclick="alfaClassification='A'; $('#alfaClass').removeClass().addClass('fa fa-refresh fa-spin fa-1x fa-fw');">A</a></li>
          <li><a style="cursor: pointer;" onclick="alfaClassification='B'; $('#alfaClass').removeClass().addClass('fa fa-refresh fa-spin fa-1x fa-fw');">B</a></li>
          <li><a style="cursor: pointer;" onclick="alfaClassification='C'; $('#alfaClass').removeClass().addClass('fa fa-refresh fa-spin fa-1x fa-fw');">C</a></li>
          <li><a style="cursor: pointer;" onclick="alfaClassification='D'; $('#alfaClass').removeClass().addClass('fa fa-refresh fa-spin fa-1x fa-fw');">D</a></li>
          <li class="divider"></li>
          <li><a style="cursor: pointer;" onclick="alfaClassification='All'; $('#alfaClass').removeClass().addClass('fa fa-refresh fa-spin fa-1x fa-fw');">All</a></li>
        </ul>
      </div>
      <div class="dropdown" style="padding-left:8px; padding-bottom:6px;">
        <button class="btn btn-primary btn-lg dropdown-toggle" type="button" data-toggle="dropdown" style="padding: 5px; width:125px; text-align: left;"><h3 class="panel-title"><b>Numeric</b><span class="pull-right" id="numClassSpan"><i class="fa fa-chevron-circle-down" aria-hidden="true" id="numClass"></i></span></h3></button>
        <ul class="dropdown-menu" style="width:225px;">
          <li><a style="cursor: pointer;" onclick="numClassification='1'; $('#numClass').removeClass().addClass('fa fa-refresh fa-spin fa-1x fa-fw');">1</a></li>
          <li><a style="cursor: pointer;" onclick="numClassification='2'; $('#numClass').removeClass().addClass('fa fa-refresh fa-spin fa-1x fa-fw');">2</a></li>
          <li><a style="cursor: pointer;" onclick="numClassification='3'; $('#numClass').removeClass().addClass('fa fa-refresh fa-spin fa-1x fa-fw');">3</a></li>
          <li><a style="cursor: pointer;" onclick="numClassification='4'; $('#numClass').removeClass().addClass('fa fa-refresh fa-spin fa-1x fa-fw');">4</a></li>
          <li><a style="cursor: pointer;" onclick="numClassification='5'; $('#numClass').removeClass().addClass('fa fa-refresh fa-spin fa-1x fa-fw');">5</a></li>
          <li class="divider"></li>
          <li><a style="cursor: pointer;" onclick="numClassification='All'; $('#numClass').removeClass().addClass('fa fa-refresh fa-spin fa-1x fa-fw');">All</a></li>
        </ul>
      </div>

      <div style="padding-left:8px;">
        <input type="text" class="form-control" placeholder="Search by name" aria-describedby="basic-addon1" style="padding: 5px; display: inline-block; width:238px; height:30px;" id="searchClassification"></input><i class="fa fa-refresh fa-spin fa-1x fa-fw" aria-hidden="true" id="searchClassificationSpinner" style="display: none; color:#428bca; position:absolute; margin-left:215px; margin-top:-22px;"></i>
      </div>

    </div>
    <div class="col-xs-4 col-sm-8 col-md-8" style="display: none;" id="lastActivityMoreButton">
      <div class="squareButton" style="height: 64px;"  data-toggle="modal" data-target="#settingsModal">
        <i class="fa fa-search-plus fa-2x" aria-hidden="true" style="color: white;"></i>
        <h5 style="color: white;">More Options</h5>
      </div>
    </div>
    <!-- Last Activity More Settings Modal -->
    <div id="settingsModal" class="modal fade" role="dialog">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h4 class="modal-title">More Options</h4>
            <h5>Select different data sets to show on the report, or send the report to your email.</h5>
          </div>
          <div class="modal-body" style="max-height: 50vh; overflow-y: scroll; -webkit-overflow-scrolling: touch; padding:0px;">
            <div class="well well-sm">
              <h5>KAH</h5>
              <div class="radio-inline" onclick="radioCheck();" style="padding-right:30px;">
                <label style="font-weight: normal; cursor:pointer;"><input type="radio" id="HHradio" name="settingRadio"/>Home Health by Year</label>
              </div>
              <div class="radio-inline" onclick="radioCheck();">
                <label style="font-weight: normal; cursor:pointer;"><input type="radio" id="HPradio" name="settingRadio"/>Hospice by Year</label>
              </div>
              <br/>
              <div class="radio-inline" onclick="radioCheck();" style="padding-right:17px;">
                <label style="font-weight: normal; cursor:pointer;"><input type="radio" id="HHMTDradio" name="settingRadio"/>Home Health by Month</label>
              </div>
              <div class="radio-inline" onclick="radioCheck();">
                <label style="font-weight: normal; cursor:pointer;"><input type="radio" id="HPMTDradio" name="settingRadio"/>Hospice by Month</label>
              </div>
              <br/>
              <div class="radio-inline" onclick="radioCheck();" style="padding-right:28px;">
                <label style="font-weight: normal; cursor:pointer;"><input type="radio" id="HHYOYradio" name="settingRadio"/>Home Health by YOY</label>
              </div>
              <div class="radio-inline" onclick="radioCheck();">
                <label style="font-weight: normal; cursor:pointer;"><input type="radio" id="HPYOYradio" name="settingRadio"/>Hospice by YOY</label>
              </div>
            </div>
            <div class="well well-sm">
              <h5>KHRS</h5>
              <div class="radio-inline" onclick="radioCheck();" style="padding-right:32px;">
                <label style="font-weight: normal; cursor:pointer;"><input type="radio" id="KHRSMTDradio" name="settingRadio"/>Outpatient by Month</label>
              </div>
              <div class="radio-inline" onclick="radioCheck();">
                <label style="font-weight: normal; cursor:pointer;"><input type="radio" id="KHRSYOYradio" name="settingRadio"/>Outpatient by YOY</label>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="emailReport();"><i class="fa fa-envelope-o fa-1x" aria-hidden="true"></i> Email Report</button>
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Manager Drilldown Modal -->
    <div id="managerDrilldownModal" class="modal fade" role="dialog">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h4 class="modal-title">Manager Drilldown</h4>
            <ul class="nav nav-tabs" id="myTabs" role="tablist">
              <li role="presentation" class="active"><a style="cursor: pointer;" id="roleDrilldown-tab" role="tab" data-toggle="tab" aria-controls="home" aria-expanded="true" onclick="$('#roleHierarchy').show(); $('#roleHierarchyButtons').show();  $('#roleHierarchyText').show(); $('#usersUnderRole').hide(); $('#usersUnderRoleTableSearch').hide(); $('#roleSearchText').hide();">Role Drilldown</a></li>
              <li role="presentation"><a style="cursor: pointer;" role="tab" id="searchByName-tab" data-toggle="tab" aria-controls="profile" onclick="$('#usersUnderRole').show(); $('#usersUnderRoleTableSearch').show(); $('#roleSearchText').show(); $('#roleHierarchy').hide(); $('#roleHierarchyButtons').hide(); $('#roleHierarchyText').hide();">Search by Name or Role</a></li>
            </ul>
            <h5 id="roleHierarchyText">Select a role in the hierarchy to drilldown to an individual user.</h5>
            <h5 id="roleSearchText" style="display:none;">Use the text box below to search for a user by name or role.</h5>
            <div id="roleHierarchyButtons">
              <a style="cursor:pointer;  display: inline-block;" id="revertOneRole" onclick="revertOneRole();"><i class="fa fa-angle-left fa-2x" aria-hidden="true" ></i> Back one role</a>
              <a style="cursor:pointer; padding-left:20px;" id="revertRole" onclick="getRoles('{!$UserRole.Id}'); roleNav = []; currentRole = '{!$UserRole.Id}';"><i class="fa fa-angle-double-left fa-2x" aria-hidden="true"></i> Back to your role</a>
            </div>
            <input style="display: none; margin: auto; width: 60%;" type="search" id="usersUnderRoleTableSearch" value="" class="form-control" placeholder="Search by name or role"/>
          </div>
          <div class="modal-body" id="roleHierarchy" style="max-height: 50vh; overflow-y: scroll; -webkit-overflow-scrolling: touch; padding:0px;">
            <i class="fa fa-refresh fa-spin fa-2x fa-fw" aria-hidden="true" style="color:#428bca;"></i>
          </div>
          <div class="modal-body" id="usersUnderRole" style="display: none; max-height: 50vh; overflow-y: scroll; -webkit-overflow-scrolling: touch; padding:0px;">
            <table class="table table-bordered table-striped" id="usersUnderRoleTable">
              <thead>
                <tr>
                  <th>Roles</th>
                  <th>Name</th>
                </tr>
              </thead>
              <tbody id="usersUnderRoleTableBody">
              </tbody>
            </table>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>

      </div>
    </div>

    <div class="col-xs-12 col-sm-6 col-md-4" id="thisWeeksEventsButton">
      <div class="appLink" onclick="thisWeeksEvents()">
        <i class="fa fa-pencil fa-4x" aria-hidden="true" style="color: white;"></i>
        <span class="pull-right">
          <h5 style="color: white;">Completed Calls<b><span class="pull-right" id="completed" style="padding-left: 4px;"><i class="fa fa-refresh fa-spin fa-1x fa-fw"></i></span></b></h5>
          <h5 style="color: white;">Incomplete Calls<b><span class="pull-right" id="incomplete" style="padding-left: 4px;"><i class="fa fa-refresh fa-spin fa-1x fa-fw"></i></span></b></h5>
          <h5 style="color: white;">Planned Calls<b><span class="pull-right" id="thisWeeksEventsNumber" style="padding-left: 4px;"><i class="fa fa-refresh fa-spin fa-1x fa-fw"></i></span></b></h5>
        </span>
        <h4 style="color: white;"  id="thisWeeksEventsButtonTitle">This Weeks Events</h4>
      </div>
    </div>
    <div class="col-xs-12 col-sm-6 col-md-4" id="lastCalledReferralSources">
      <div class="appLink" onclick="lastCalledReferralSources()">
        <i class="fa fa-phone fa-4x" aria-hidden="true" style="color: white;"></i>
        <h4 style="color: white;">My Assignments<span class="pull-right" id="lastCalledReferralSourcesNumber"><i class="fa fa-refresh fa-spin fa-1x fa-fw"></i></span></h4>
      </div>
    </div>
    <div class="col-xs-12 col-sm-6 col-md-4" id="SPButton">
      <div class="appLink" onclick="SalesPerformance()">
        <i class="fa fa-pie-chart fa-4x" aria-hidden="true" style="color: white;"></i>
        <span class="pull-right">
          <h5 style="color: white;">HH Admits<b><span class="pull-right" id="HHPercent" style="padding-left: 4px;"><i class="fa fa-refresh fa-spin fa-1x fa-fw"></i></span></b></h5>
          <h5 style="color: white;">HP Admits<b><span class="pull-right" id="HPPercent" style="padding-left: 4px;"><i class="fa fa-refresh fa-spin fa-1x fa-fw"></i></span></b></h5>
          <h5 style="color: white;">Sales Calls<b><span class="pull-right" id="SalesCallsPercent" style="padding-left: 4px;"><i class="fa fa-refresh fa-spin fa-1x fa-fw"></i></span></b></h5>
        </span>
        <h4 style="color: white;">Sales Performance </h4>
      </div>
    </div>
    <div class="col-xs-12 col-sm-6 col-md-4" id="recentBirthdaysButton">
      <div class="appLink" onclick="recentBirthdays()">
        <i class="fa fa-birthday-cake fa-4x" aria-hidden="true" style="color: white;"></i>
        <h4 style="color: white;">Recent Birthdays<span class="pull-right" id="recentBirthdaysNumber"><i class="fa fa-refresh fa-spin fa-1x fa-fw"></i></span></h4>
      </div>
    </div>
    <div class="col-xs-12 col-sm-6 col-md-4" id="reportsButton">
      <div class="appLink" onclick="reports()">
        <i class="fa fa-file-text-o fa-4x" aria-hidden="true" style="color: white;"></i>
        <h4 style="color: white;">Reports<span class="pull-right" id="reportsNumber"><i class="fa fa-refresh fa-spin fa-1x fa-fw"></i></span></h4>
      </div>
    </div>
    <div class="col-xs-12 col-sm-6 col-md-4" id="marketingToolButton">
      <div class="appLink" onclick="marketingTool()">
        <i class="fa fa-cart-arrow-down fa-4x" aria-hidden="true" style="color: white;"></i>
        <h4 style="color: white;">Marketing Collaterals</h4>
      </div>
    </div>
  </div>
  <div class="row" style="padding-top:10px;">
    <div class="col-xs-12 col-sm-12 col-md-12" id="thisWeeksEvents" style="display: none;">
      <div class="col-xs-12 col-sm-12 col-md-12" id="thisWeeksEventsAlert" style="display: none; padding:0px;">
        <div class="alert alert-info" role="alert"><span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span><b> You have not logged any events <span id="thisWeeksEventsAlertText">this week</span>! </b>Please log some events and check again to view your weekly events.</div>
      </div>
      <div class="panel panel-primary" id="thisWeeksEventsPanel" >
        <div class="panel-heading" style="padding-left: 8px;">
          <h3 class="panel-title"><b id="thisWeeksEventsPanelTitle">This Week's Events</b><span class="pull-right" id="thisWeeksEventsNumberOnPannel"><i class="fa fa-refresh fa-spin fa-1x fa-fw" aria-hidden="true" id="refreshEvents"></i></span></h3>
        </div>
        <div class="panel-body" style="overflow: hidden; overflow-y:scroll; -webkit-overflow-scrolling: touch;" id="thisWeeksEventsPanelBody">
          <table id="thisWeeksEventsTable" class="table table-hover goup sortable">
            <thead>
              <tr>
                <th class="col-md-1">Date</th>
                <th class="col-md-2">Subject</th>
                <th class="col-md-2" id="AccountContactColumn">Contact</th>
                <th class="col-md-1">Completed</th>
              </tr>
            </thead>
            <tbody id="tableDataThisWeeksEvents">
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="col-xs-12 col-sm-12 col-md-12" style="display: none;" id="reports">
      <div class="panel-group" id="reportaccordion">
        <div class="panel panel-primary">
          <div class="panel-heading" style="padding-left: 8px;">
            <h3 class="panel-title"><b>Reports</b></h3>
          </div>
          <div class="panel-body" id="reportsPanel" style="overflow-y: scroll; -webkit-overflow-scrolling: touch;">
          </div>
        </div>
      </div>
    </div>

    <div class="col-xs-12 col-sm-12 col-md-12" id="SalesPerformance" style="display: none;">
      <div class="alert alert-danger" role="alert" id="dateIterateAlert" style="display:none;"><i class="fa fa-exclamation-triangle" aria-hidden="true"></i><b> You have gone too far in the future or past! </b> There is only a one year range for Sales Performances.</div>
      <div class="alert alert-info" role="alert" id="SPAlert" style="display:none;"><span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span><b> The sales performance for <span id="SPMonthAlert">this month</span> is not available! </b>Please check again soon, or contact your supervisor for more information.</div>
      <div class="panel panel-primary" id="SPpanel">
        <div class="panel-heading" style="padding-left: 8px;">
          <h3 class="panel-title">Sales Performance<span class="pull-right"><b id="SPMonth"><i class="fa fa-refresh fa-spin fa-1x fa-fw" aria-hidden="true"></i></b></span></h3>
        </div>
        <div class="panel-body" id="SalesPerformancePanel" style="overflow-y: scroll; -webkit-overflow-scrolling: touch;">
          <div class="col-xs-12 col-sm-4 col-md-4">
            <div id="centerme">
              <div style="margin-left: 40px;" id="titleHHandAdmits"></div>
              <div style="width: 256; height: 256; float: left; position: relative;">
                <div id="centerText">
                  <h4 style="margin: 0px; padding-left: 30px;" id="percentHHandAdmits"></h4>
                </div>
                <div style="padding-left: 25px;">
                  <canvas id="HHandAdmits" width="300" height="200"></canvas>
                </div>
              </div>
            </div>
          </div>
          <div class="col-xs-12 col-sm-4 col-md-4">
            <div class="centerme">
              <div style="margin-left: 20px;" id="titleHPandRevenue"></div>
              <div style="width: 256; height: 256; float: left; position: relative;">
                <div id="centerText">
                  <h4 style="margin: 0px; padding-left: 10px;" id="percentHPandRevenue"></h4>
                </div>
                <canvas id="HPandRevenue" width="300" height="200"></canvas>
              </div>
            </div>
          </div>
          <div class="col-xs-12 col-sm-4 col-md-4">
            <div class="centerme">
              <div style="margin-left: 52px;" id="titleSPCalls"><h4>Sales Calls</h4></div>
              <div style="width: 256; height: 256; float: left; position: relative;">
                <div id="centerText">
                  <h4 style="margin: 0px; padding-left: 15px;" id="percentSPCalls"></h4>
                </div>
                <canvas id="SPCalls" width="300" height="200"></canvas>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-xs-12 col-sm-12 col-md-12" id="recentBirthdays" style="display: none;">
      <div class="alert alert-info" role="alert" id="recentBirthdaysAlert" style="display:none;"><span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span><b> There are no recent birthdays for your contacts! </b>Please check again soon, or contact your supervisor for more information.</div>
      <div class="panel panel-primary" id="recentBirthdaysPanel">
        <div class="panel-heading" style="padding-left: 8px;">
          <h3 class="panel-title"><b>Recent Birthdays</b></h3>
        </div>
        <div class="panel-body" id="recentBirthdaysPanelBody" style="padding-top: 10px; overflow-y: scroll; -webkit-overflow-scrolling: touch;">
        </div>
      </div>
    </div>

    <div class="col-xs-12 col-sm-12 col-md-12" id="lastActivityByClassification" style="display:none;">

      <div id="emailAlert" class="alert alert-success" style="display: none;"><b><i class="fa fa-thumbs-o-up" aria-hidden="true"></i> Success!</b> This report has been emailed to your inbox.</div>
      <div class="alert alert-info" role="alert" style="display:none;" id="lastActivityByClassificationAlert"><span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span><b> There are no accounts or contacts that meet your criteria! </b>Please set the account classification for your accounts and contacts to resolve this.</div>
      <div class="panel panel-primary" id="lastActivityByClassificationPanel">
        <div class="panel-heading" style="padding-left: 8px;">
          <h3 class="panel-title"><b>My Assignments</b><span class="pull-right" id="lastActivityByClassificationNumberOnPanel"><i class="fa fa-refresh fa-spin fa-1x fa-fw" aria-hidden="true" id="refreshClassification"></i></span></h3>
          <h5 id="lastCalledSubTitle" style="margin: 0px; font-style: italic;">My Assignments Subtitle</h5>
        </div>
        <div class="panel-body" id="lastActivityByClassificationPanelBody" style="overflow-y: scroll; -webkit-overflow-scrolling: touch;">

          <table id="lastActivityByClassificationTable" class="table table-hover goup sortable" width="100%">
            <thead>
              <tr>
                <th class="col-xs-7 col-md-5">Name</th>
                <th class="col-xs-1 col-md-2" id="currentTH"></th>
                <th class="col-xs-1 col-md-2" id="priorTH"></th>
                <th class="col-xs-1 col-md-1">AC</th>
                <th class="col-xs-2 col-md-2" style="text-align:center;" data-defaultsort="desc">Last Called</th>
              </tr>
            </thead>
            <tbody id="lastActivityByClassificationTableBody">
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="col-xs-12 col-sm-12 col-md-12" id="lastLogin" style="display:none;">
      <div class="alert alert-info" role="alert" style="display:none;" id="lastLoginAlert"><span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span><b> There were no users found that you manage.</b></div>
      <div class="panel panel-primary" id="lastLoginPanel">
        <div class="panel-heading" style="padding-left: 8px;">
          <h3 class="panel-title"><b>Login Report</b><span class="pull-right" id="lastLoginNumberOnPanel"><i class="fa fa-refresh fa-spin fa-1x fa-fw" aria-hidden="true" id="refreshLastLogin"></i></span></h3>
          <h5 style="margin: 0px; font-style: italic;">Number of Days Since Last Login by User</h5>
        </div>
        <div class="panel-body" id="lastLoginPanelBody" style="overflow-y: scroll; -webkit-overflow-scrolling: touch;">

          <table id="lastLoginTable" class="table table-hover goup sortable" width="100%">
            <thead>
              <tr>
                <th class="col-xs-7 col-md-5">Name</th>
                <th class="col-xs-2 col-md-2" style="text-align:center;" data-defaultsort="asc">Last Login</th>
              </tr>
            </thead>
            <tbody id="lastLoginTableBody">
            </tbody>
          </table>
        </div>
      </div>
    </div>

  </div>
</div>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
<script src="https://www.google.com/jsapi"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/1.1.1/Chart.min.js"></script>
<script src="https://cdn.jsdelivr.net/bootstrap-sortable/2.0.0/bootstrap-sortable.min.js"></script>

<script>
//Navigation
function thisWeeksEvents(){
  $("#thisWeeksEvents").show();
  $("#weekButtons").show();
  $("#newEventButton").show();
  $("#goToCalendar").show();
  $("#goBackButton").show();
  $("#thisWeeksEventsButton").hide();
  $("#reportsButton").hide();
  $("#recentBirthdaysButton").hide();
  $("#marketingToolButton").hide()
  $("#SPButton").hide();
  $("#lastCalledReferralSources").hide();
}

function SalesPerformance(){
  $("#SPButtons").show();
  $("#SalesPerformance").show();
  SPData();
  $("#goBackButton").show();
  $("#SPButton").hide();
  $("#recentBirthdaysButton").hide();
  $("#reportsButton").hide();
  $("#thisWeeksEventsButton").hide();
  $("#marketingToolButton").hide()
  $("#lastCalledReferralSources").hide();
}

function recentBirthdays(){
  $("#recentBirthdays").show();
  getBirthdays();
  $("#goBackButton").show();
  $("#recentBirthdaysButton").hide();
  $("#thisWeeksEventsButton").hide();
  $("#reportsButton").hide();
  $("#marketingToolButton").hide()
  $("#SPButton").hide();
  $("#lastCalledReferralSources").hide();
}

function reports(){
  $("#reports").show();
  $("#goBackButton").show();
  $("#recentBirthdaysButton").hide();
  $("#reportsButton").hide();
  $("#thisWeeksEventsButton").hide();
  $("#SPButton").hide();
  $("#marketingToolButton").hide()
  $("#lastCalledReferralSources").hide();
}

function lastActivityButtons(){
  $("#reports").show();
  $("#goBackButton").show();
  $("#lastActivityByClassification").hide();
  $("#exitReport").hide();
}

function lastCalledReferralSources(){
  $("#lastActivityButtons").show();
  $("#lastActivityMoreButton").show();
  $("#lastActivityByClassification").show();
  $("#goBackButton").show();
  $("#recentBirthdaysButton").hide();
  $("#thisWeeksEventsButton").hide();
  $("#marketingToolButton").hide()
  $("#reportsButton").hide();
  $("#SPButton").hide();
  $("#lastCalledReferralSources").hide();
}

function goBack(){
  $("#SPButtons").hide();
  $("#lastActivityButtons").hide();
  $("#lastActivityMoreButton").hide();
  $("#weekButtons").hide();
  $("#thisWeeksEvents").hide();
  $("#SalesPerformance").hide();
  $("#goBackButton").hide();
  $("#recentBirthdays").hide();
  $("#reports").hide();
  $("#newEventButton").hide();
  $("#goToCalendar").hide();
  $("#lastActivityByClassification").hide();
  $("#thisWeeksEventsButton").show();
  $("#marketingToolButton").show()
  $("#reportsButton").show();
  $("#recentBirthdaysButton").show();
  $("#SPButton").show();
  $("#lastCalledReferralSources").show();
  getThisWeeksEvents();
  SPData();
  getBirthdays();
}

function toggleChevron(e) {
  $(e.target)
  .prev('.panel-heading')
  .find("span.glyphicon")
  .toggleClass('glyphicon-chevron-down glyphicon-chevron-right');
}
$('#reportaccordion').on('hidden.bs.collapse', toggleChevron);
$('#reportaccordion').on('shown.bs.collapse', toggleChevron);

</script>
<script>
$( document ).ready(function() {
  if ('{!$Profile.Name}'.indexOf('Manager')<0){
    lastLogin
    $("#lastLogin").remove();
    $("#managerDrilldownModal").remove();
    $("#managerDrilldownButton").remove();
  } else {
    getUsersUnderRole();
    $("#managerDrilldownButton").show();
  }

  if('{!$Profile.Name}'.indexOf('KHRS')>=0){
    $("#SPButton").remove();
    $("#SPButtons").remove();
    $("#SalesPerformance").remove();
  }

  SALES_LaunchpadController.getDefaultRadio('{!$User.Id}', function(result, event){
    var r = result[0];
    if(r.Line_of_Business__c != null){
      if (r.Line_of_Business__c.indexOf('HH')>=0){
        $("#HHradio").prop("checked", true);
        radioCheck();
      } else if (r.Line_of_Business__c.indexOf('HP')>=0){
        $("#HPradio").prop("checked", true);
        radioCheck();
      } else if (r.Line_of_Business__c.indexOf('KHRS - OP')>=0){
        $("#KHRSMTDradio").prop("checked", true);
        radioCheck();
      }
    }
  }, {escape:true});
  radioCheck();
  resize();
  SPData();
  getThisWeeksEvents();
  getReports();
  getBirthdays();
  getLastActivityByClassification();
});

window.setInterval(function(){
  getThisWeeksEvents();
  getLastActivityByClassification(alfaClassification);
  resize();
}, 2500);

function resize()
{
  var heights = window.innerHeight - 200;
  if ('{!$Profile.Name}'.indexOf('Manager')>=0){
    document.getElementById("thisWeeksEventsPanelBody").style.maxHeight = (heights-80) + "px";
    document.getElementById("lastActivityByClassificationPanelBody").style.maxHeight = (heights-45) + "px";
    document.getElementById("lastLoginPanelBody").style.maxHeight = (heights-45) + "px";
    document.getElementById("recentBirthdaysPanelBody").style.maxHeight = heights + "px";
  } else {
    document.getElementById("thisWeeksEventsPanelBody").style.maxHeight = (heights-40) + "px";
    document.getElementById("recentBirthdaysPanelBody").style.maxHeight = heights + "px";
    document.getElementById("lastActivityByClassificationPanelBody").style.maxHeight = (heights-5) + "px";
  }
}

window.onresize = function() {
  resize();
};
</script>
<script>
var IsKAHRecTypeSP = false;

var weekIterator = 0;
function weekIterate(num){
  weekIterator = weekIterator + num;
  if (weekIterator==0){
    $("#thisWeeksEventsButtonTitle").html('This Week\'s Events');
    $("#thisWeeksEventsPanelTitle").html('This Week\'s Events');
    $("#thisWeeksEventsAlertText").html('this week');
  } else if (weekIterator==1){
    $("#thisWeeksEventsButtonTitle").html('Next Week\'s Events');
    $("#thisWeeksEventsPanelTitle").html('Next Week\'s Events');
    $("#thisWeeksEventsAlertText").html('next week');
  } else if (weekIterator==-1){
    $("#thisWeeksEventsButtonTitle").html('Last Week\'s Events');
    $("#thisWeeksEventsPanelTitle").html('Last Week\'s Events');
    $("#thisWeeksEventsAlertText").html('last week');
  }  else if (weekIterator>1){
    $("#thisWeeksEventsButtonTitle").html('Events in '+weekIterator+' Weeks');
    $("#thisWeeksEventsPanelTitle").html('Events in '+weekIterator+' Weeks');
    $("#thisWeeksEventsAlertText").html('in '+weekIterator+' weeks');
  }   else if (weekIterator<1){
    $("#thisWeeksEventsButtonTitle").html('Events '+Math.abs(weekIterator)+' Weeks Ago');
    $("#thisWeeksEventsPanelTitle").html('Events '+Math.abs(weekIterator)+' Weeks Ago');
    $("#thisWeeksEventsAlertText").html(+Math.abs(weekIterator)+' weeks ago');
  }
}

function getThisWeeksEvents(){
  SALES_LaunchpadController.getThisWeeksEvents(usrId, weekIterator, function(result, event){
    var html = '';
    var incompleteCalls=0, completedCalls=0, plannedCalls=0;



    if (result.length == 0){
      $("#thisWeeksEventsPanel").hide();
      $("#thisWeeksEventsAlert").show();
    } else {
      $("#thisWeeksEventsPanel").show();
      $("#thisWeeksEventsAlert").hide();
      plannedCalls = result.length;
      for (var i=0; i<result.length; i++){
        var r = result[i];

        var recur = '';
        if(r.RecurrenceActivityId != null){
          recur = '<i class="fa fa-refresh fa-1x" aria-hidden="true" style="padding-left:10px; color: #428bca;"></i>';
        }

        if(r.Complete__c) completedCalls++;
        else incompleteCalls++;

        var accountContact='', complete='', contact='';
        var date = new Date(r.ActivityDateTime);

        date = date.toLocaleDateString() + ' ' + date.toLocaleTimeString();
        date = date.replace(/:\d\d /, '');


        if (r.Complete__c){
          complete += '<i class="fa fa-check fa-1x" aria-hidden="true" style="color: #5cb85c;"></i> Completed';
        } else {
          complete += '<i class="fa fa-times fa-1x" aria-hidden="true" style="color: #b52b27;"></i> Incomplete';
        }
        if(accountsFcontactsT){
          if (r.WhoId == null){
            accountContact = '<i class="fa fa-times-circle-o" aria-hidden="true"></i>';
          } else {
            accountContact = '<a href="javascript:navigateTo(&quot;'+r.WhoId+'&quot;, &quot;view&quot;)">'+r.Who.Name+'</a>';
          }
        } else {
          if (r.WhatId == null){
            accountContact = '<i class="fa fa-times-circle-o" aria-hidden="true"></i>';
          } else {
            accountContact = '<a href="javascript:navigateTo(&quot;'+r.WhatId+'&quot;, &quot;view&quot;)">'+r.What.Name+'</a>';
          }
        }
        html +='<tr>'+
        '<td>'+date+'</td>'+
        '<td><a href="javascript:navigateTo(&quot;'+r.Id+'&quot;, &quot;view&quot;)">'+r.Subject+'</a>'+recur+'</td>'+
        '<td>'+accountContact+'</td>'+
        '<td>'+complete+'</td>'+
        '</tr>';
      }
      document.getElementById("tableDataThisWeeksEvents").innerHTML = html;
      $.bootstrapSortable(true);
      document.getElementById("thisWeeksEventsNumberOnPannel").innerHTML = plannedCalls;

    }
    document.getElementById("completed").innerHTML = completedCalls;
    document.getElementById("incomplete").innerHTML = incompleteCalls;
    document.getElementById("thisWeeksEventsNumber").innerHTML = plannedCalls;

    if(accountsFcontactsT){
      document.getElementById("toggleAccountsContacts").innerHTML = '<span class="pull-left" style="margin-top:2px; padding-right:5px;"><i class="fa fa-building fa-2x" aria-hidden="true"></i></span>View<br/>Account';
      document.getElementById("AccountContactColumn").innerHTML = 'Contact';
    } else{
      document.getElementById("toggleAccountsContacts").innerHTML = '<span class="pull-left" style="margin-top:2px; padding-right:5px;"><i class="fa fa-user-md fa-2x" aria-hidden="true"></i></span>View<br/>Contact';
      document.getElementById("AccountContactColumn").innerHTML = 'Account';
    }

  }, {escape:true});
  $("#drilldownSpinnerEvents").hide();
}

var accountsFcontactsT = true;
function toggleAccountsContacts(){
  accountsFcontactsT = !accountsFcontactsT;
  document.getElementById("toggleAccountsContacts").innerHTML = '<span class="pull-left" style="margin-top:2px; padding-right:5px;"><i class="fa fa-refresh fa-spin fa-2x fa-fw" aria-hidden="true"></i></span>';
}

var dateIterator = 0;
function dateIterate(num){
  if ((dateIterator == 12 && num > 0) || (dateIterator == -12 && num < 0)){
    $("#dateIterateAlert").fadeIn('400');
    setTimeout(function() { $("#dateIterateAlert").fadeOut('400'); }, 4000);
  } else {
    dateIterator = dateIterator + num;
  }
}


function SPData(){
  if ('{!$Profile.Name}'.indexOf('KAH')>=0){
    var months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
    var currentDate = new Date();
    var monthNum = currentDate.getMonth()+dateIterator;
    var yearNum = currentDate.getFullYear();
    if (monthNum >= 12){
      monthNum = monthNum-12;
      yearNum = yearNum+1;
    } else if (monthNum < 0){
      monthNum = monthNum+12;
      yearNum = yearNum-1;
    }

    document.getElementById("SPMonth").innerHTML = months[monthNum] + ' '+yearNum;
    document.getElementById("SPMonthAlert").innerHTML = months[monthNum] + ' '+yearNum;

    SALES_LaunchpadController.getSPData(usrId, dateIterator, function(result, event){
      if (result.length == 0){
        $("#SPAlert").fadeIn('400');
        $("#SPpanel").hide();
        document.getElementById("HHPercent").innerHTML = '0.0%';
        document.getElementById("HPPercent").innerHTML = '0.0%';
      } else {
        $("#SPAlert").fadeOut('400');
        $("#SPpanel").show();


        var ctxHPandRevenue = $("#HPandRevenue").get(0).getContext("2d");
        var ctxHHandAdmits = $("#HHandAdmits").get(0).getContext("2d");
        ctxHPandRevenue.canvas.width = 200;
        ctxHPandRevenue.canvas.height = 200;
        ctxHHandAdmits.canvas.width = 200;
        ctxHHandAdmits.canvas.height = 200;
        var targetHPandRevenue, targetHHandAdmits;
        var actualHPandRevenue, actualHHandAdmits;

        if (result[0].RecordType != null && result[0].RecordType.Name == 'KAH'){
          IsKAHRecTypeSP = true;
          document.getElementById("titleHPandRevenue").innerHTML = '<h4 style="padding-left: 40px;">HP Admits</h4>';

          if (result[0].KAH_HP_Admit_Target__c != null) targetHPandRevenue = result[0].KAH_HP_Admit_Target__c;
          else targetHPandRevenue = 0;

          if (result[0].KAH_HP_Total_Admits__c != null) actualHPandRevenue = result[0].KAH_HP_Total_Admits__c;
          else actualHPandRevenue = 0;

          document.getElementById("titleHHandAdmits").innerHTML = '<h4 style="padding-left: 40px;">HH Admits</h4>';

          if (result[0].KAH_HH_Admit_Target__c != null) targetHHandAdmits = result[0].KAH_HH_Admit_Target__c;
          else targetHHandAdmits = 0;

          if (result[0].KAH_HH_PPS_Qualified_Admits__c != null) actualHHandAdmits = result[0].KAH_HH_PPS_Qualified_Admits__c;
          else actualHHandAdmits = 0;

        } else {
          document.getElementById("titleHPandRevenue").innerHTML = '<h4 style="padding-left: 40px;">Revenue</h4>';
          if (result[0].Targeted_Revenue__c != null) targetHPandRevenue = result[0].Targeted_Revenue__c;
          else targetHPandRevenue = 0;

          if (result[0].Actual_Revenue__c != null) actualHPandRevenue = result[0].Actual_Revenue__c;
          else actualHPandRevenue = 0;

          document.getElementById("titleHHandAdmits").innerHTML = '<h4 style="padding-left: 40px;">Admissions</h4>';

          if (result[0].Targeted_Admissions__c != 0) targetHHandAdmits = result[0].Targeted_Admissions__c;
          else targetHHandAdmits = 0;

          if (result[0].Actual_Admissions__c != 0) actualHHandAdmits = result[0].Actual_Admissions__c;
          else actualHHandAdmits = 0;

        }

        var colorHPandRevenue;
        var percentageHPandRevenue = (actualHPandRevenue/targetHPandRevenue)*100;
        if(percentageHPandRevenue.toString().indexOf('.') >= 0){
          if (isNaN(percentageHPandRevenue)){
            document.getElementById("percentHPandRevenue").innerHTML = '0.0%';
            document.getElementById("HPPercent").innerHTML = '0.0%';
          } else {
            document.getElementById("percentHPandRevenue").innerHTML =
            percentageHPandRevenue.toString().substring(0, percentageHPandRevenue.toString().indexOf('.')+2)+'%';
            document.getElementById("HPPercent").innerHTML =
            percentageHPandRevenue.toString().substring(0, percentageHPandRevenue.toString().indexOf('.')+2)+'%';
          }
        } else{
          if (isNaN(percentageHPandRevenue)){
            document.getElementById("percentHPandRevenue").innerHTML = '0.0%';
            document.getElementById("HPPercent").innerHTML = '0.0%';
          } else {
            document.getElementById("percentHPandRevenue").innerHTML = percentageHPandRevenue.toString()+'.0%';
            document.getElementById("HPPercent").innerHTML = percentageHPandRevenue.toString()+'.0%';
          }
        }

        var colorHHandAdmits;
        var percentageHHandAdmits = (actualHHandAdmits/targetHHandAdmits)*100;
        if(percentageHHandAdmits.toString().indexOf('.') >= 0){
          if (isNaN(percentageHHandAdmits)){
            document.getElementById("percentHHandAdmits").innerHTML = '0.0%';
            document.getElementById("HHPercent").innerHTML = '0.0%';
          } else {
            document.getElementById("percentHHandAdmits").innerHTML =
            percentageHHandAdmits.toString().substring(0, percentageHHandAdmits.toString().indexOf('.')+2)+'%';
            document.getElementById("HHPercent").innerHTML =
            percentageHHandAdmits.toString().substring(0, percentageHHandAdmits.toString().indexOf('.')+2)+'%';
          }

        } else {
          if (isNaN(percentageHHandAdmits)){
            document.getElementById("percentHHandAdmits").innerHTML = '0.0%';
            document.getElementById("HHPercent").innerHTML = '0.0%';
          } else {
            document.getElementById("percentHHandAdmits").innerHTML = percentageHHandAdmits.toString()+'.0%';
            document.getElementById("HHPercent").innerHTML = percentageHHandAdmits.toString()+'.0%';
          }
        }

        if (percentageHPandRevenue >= 105){
          colorHPandRevenue = "#4FBAF8";
        } else if (percentageHPandRevenue >= 100){
          colorHPandRevenue = "#52D76C";
        } else if (percentageHPandRevenue >= 85){
          colorHPandRevenue = "#FEDF6B";
        } else {
          colorHPandRevenue = "#E3686C";
        }

        if (percentageHHandAdmits >= 105){
          colorHHandAdmits = "#4FBAF8";
        } else if (percentageHHandAdmits >= 100){
          colorHHandAdmits = "#52D76C";
        } else if (percentageHHandAdmits >= 85){
          colorHHandAdmits = "#FEDF6B";
        } else {
          colorHHandAdmits = "#E3686C";
        }

        var dataHPandRevenue = [
          {
            value: actualHPandRevenue,
            color: colorHPandRevenue,
            label: "Actual"
          }
        ];

        var dataHHandAdmits = [
          {
            value: actualHHandAdmits,
            color: colorHHandAdmits,
            label: "Actual"
          }
        ];

        var targetHPandRevenueLessActual = 0;
        if((targetHPandRevenue - actualHPandRevenue)>0){
          targetHPandRevenueLessActual = targetHPandRevenue - actualHPandRevenue;
          var targetHPandRevenueData = {
            //value: targetHPandRevenueLessActual,
            value: Math.round(targetHPandRevenueLessActual * 100) / 100,
            color: "lightgrey",
            label: "To Goal"
          };
          dataHPandRevenue.push(targetHPandRevenueData);
        }

        var targetHHandAdmitsLessActual = 0;
        if((targetHHandAdmits - actualHHandAdmits)>0){
          targetHHandAdmitsLessActual = targetHHandAdmits - actualHHandAdmits;
          var targetHHandAdmitsData = {
            //value: targetHHandAdmitsLessActual,
            value: Math.round(targetHHandAdmitsLessActual * 100) / 100,
            color: "lightgrey",
            label: "To Goal"
          };
          dataHHandAdmits.push(targetHHandAdmitsData);
        }

        var toolTip;

        if (result[0].RecordType != null && result[0].RecordType.Name == 'KAH') toolTip = "<%= label %>: <%= addCommas(value) %>";
        else toolTip = "<%= label %>: $<%= addCommas(value) %>";

        var options = {
          responsive: false,
          maintainAspectRatio: false,
          tooltipTemplate: toolTip,
          onAnimationComplete: function(){this.showTooltip(this.segments, true);},
          tooltipEvents: [],
          showTooltips: true,
          tooltipFillColor: "rgba(0,0,0,0.6)",
          tooltipCaretSize: 4,
          tooltipXPadding: 3,
          tooltipYPadding: 3,
          tooltipFontSize: 10
        }

        var chart = new Chart(ctxHPandRevenue).Doughnut(dataHPandRevenue, options);
        var chart2 = new Chart(ctxHHandAdmits).Doughnut(dataHHandAdmits, options);

      }
    }, {escape:true});

    SALES_LaunchpadController.getSPDataSalesCalls(usrId, dateIterator, function(result, event){

      if (result.length == 0){
        var ctx = $("#SPCalls").get(0).getContext("2d");
        ctx.canvas.width = 200;
        ctx.canvas.height = 200;
        ctx.clearRect(0, 0, 200, 200);
        var chart = new Chart(ctx);
        document.getElementById("SalesCallsPercent").innerHTML = '0.0%';
        document.getElementById("percentSPCalls").innerHTML = '0.0%';
      } else {
        var incomplete=result[0].Planned_Sales_Calls__c-result[0].Sales_Calls__c, complete=result[0].Sales_Calls__c;

        /*
        for (var i=0; i<result.length; i++){
        var r = result[i];
        if(r.Complete__c) complete++;
        else incomplete++;
      }
      */

      var percentage = (complete/168)*100;
      if(percentage.toString().indexOf('.') >= 0){
        document.getElementById("percentSPCalls").innerHTML =
        percentage.toString().substring(0, percentage.toString().indexOf('.')+2)+'%';
        document.getElementById("SalesCallsPercent").innerHTML =
        percentage.toString().substring(0, percentage.toString().indexOf('.')+2)+'%';
      } else{
        document.getElementById("percentSPCalls").innerHTML = percentage.toString()+'.0%';
        document.getElementById("SalesCallsPercent").innerHTML = percentage.toString()+'.0%';
      }

      var ctx = $("#SPCalls").get(0).getContext("2d");
      ctx.canvas.width = 200;
      ctx.canvas.height = 200;

      var data;
      var color;

      if (IsKAHRecTypeSP){
        var percent = (complete/168)*100;

        if (percent >= 105){
          color = "#4FBAF8";
        } else if (percent >= 100){
          color = "#52D76C";
        } else if (percent >= 85){
          color = "#FEDF6B";
        } else {
          color = "#E3686C";
        }
        data = [
          {
            value: incomplete,
            color: "darkgrey",
            label: "Incomplete"
          },
          {
            value: complete,
            color: color,
            label: "Completed"
          }
        ];

        if((168-(incomplete+complete))>0){
          var toGoalData = {
            value: 168-(incomplete+complete),
            color: "lightgrey",
            label: "To Goal"
          };
          data.push(toGoalData);
        }
      } else {
        data = [
          {
            value: result.length,
            color: "CornflowerBlue",
            label: "Completed"
          }
        ];

        if((168-(result.length))>0){
          var toGoalData = {
            value: 168-(result.length),
            color: "lightgrey",
            label: "To Goal"
          };
          data.push(toGoalData);
        }
      }

      var options = {
        responsive: false,
        maintainAspectRatio: false,
        tooltipTemplate: "<%= label %>: <%= addCommas(value) %>",
        onAnimationComplete: function(){this.showTooltip(this.segments, true);},
        tooltipEvents: [],
        showTooltips: true,
        tooltipFillColor: "rgba(0,0,0,0.6)",
        tooltipCaretSize: 4,
        tooltipXPadding: 3,
        tooltipYPadding: 3,
        tooltipFontSize: 10
      }

      var chart = new Chart(ctx).Doughnut(data, options);

    }
  }, {escape:true});
  $('#monthDropdownSpinner').html('<i class="fa fa-chevron-circle-down" aria-hidden="true"></i>');
}
}

function getBirthdays(){
  SALES_LaunchpadController.getRecentBirthdays('{!$User.Id}', function(result, event){
    var html = '';
    if (result.length == 0){
      $("#recentBirthdaysAlert").fadeIn('400');
      $("#recentBirthdaysPanel").hide();
      document.getElementById("recentBirthdaysNumber").innerHTML = 0;
    } else {
      $("#recentBirthdaysAlert").fadeOut('400');
      $("#recentBirthdaysPanel").show();
      document.getElementById("recentBirthdaysNumber").innerHTML = result.length;
      for (var i=0; i<result.length; i++){
        var r = result[i];
        var date = new Date(r.Contact__r.Birthdate);
        date.setDate(date.getDate() + 1);
        bday = date.toLocaleDateString();
        if(r.Title__c == null){
          title = '<span class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span>';
        } else {
          title = r.Contact__r.Title__c;
        }

        html += '<div class="col-xs-12 col-sm-6 col-md-4"><div class="well well-sm" style=" min-height: 70px;">';
        html += '<span class="pull-left"><i class="fa fa-user-md fa-4x" aria-hidden="true"></i></span>';
        html += '<b style="font-size: 18px; line-height: 1px; padding-left: 10px;"><a href="javascript:navigateTo(&quot;'+r.Contact__c+'&quot;, &quot;view&quot;)"> '+r.Contact__r.Name+'</a></b><p style="font-size: 14px; line-height: 13px; padding-left: 55px;"><b> Title: </b>'+title+'<b></br> Birthdate: </b>'+bday+'</p>';
        html += '</div></div>';
      }
      document.getElementById("recentBirthdaysPanelBody").innerHTML = html;
    }

  }, {escape:true});
}

function getReports(){
  var reportFolder = '';
  if ('{!$Profile.Name}'.indexOf('KAH')>=0){
    reportFolder = 'Sales: KAH Reports';
  } else if ('{!$Profile.Name}'.indexOf('KHRS')>=0){
    reportFolder = 'Sales: KHRS OP Reports';
  }
  SALES_LaunchpadController.getReports(reportFolder, function(result, event){
    var html = '';
    if (result.length == 0){
      document.getElementById("reportsNumber").innerHTML = 0;
      document.getElementById("reports").innerHTML = '<div class="alert alert-info" role="alert"><span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span><b> Your reports are not available! </b>Please check again soon, or contact your supervisor for more information.</div>';
    } else {
      document.getElementById("reportsNumber").innerHTML = result.length;

      for (var i=0; i<result.length; i++){
        var r = result[i];

        var name, description;
        if(r.Name == null){
          name = '<span class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span>';
        } else {
          name = r.Name;
        }

        if(r.Description == null){
          description = '<span class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span> No Description Provided';
        } else {
          description = r.Description;
        }

        html += '<div class="panel panel-default">' +
        '<div class="panel-heading">' +
        '<h4 class="panel-title">' +
        '<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#collapse'+i+'">';
        if(i==0) html += '<span class="glyphicon glyphicon-chevron-down" style="padding-right: 10px;"></span>';
        else     html += '<span class="glyphicon glyphicon-chevron-right" style="padding-right: 10px;"></span>';
        html+= '<a style="color: #428bca;" href="javascript:navigateTo(&quot;'+r.Id+'&quot;, &quot;report&quot;)"> '+name+'</a>' +
        '</a>' +
        '</h4>' +
        '</div>';
        if(i==0) html+= '<div id="collapse'+i+'" class="panel-collapse collapse in">';
        else     html += '<div id="collapse'+i+'" class="panel-collapse collapse">';
        html += '<div class="panel-body" style="padding-left: 45px;">' +
        description +
        '</div>' +
        '</div>' +
        '</div>';

      }

      if('{!$Profile.Name}'.indexOf('Manager')>=0){
        document.getElementById("reportsNumber").innerHTML++;
        html += '<div class="panel panel-default">' +
        '<div class="panel-heading">' +
        '<h4 class="panel-title">' +
        '<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#collapse'+result.length+'">';
        if(result.length==0) html += '<span class="glyphicon glyphicon-chevron-down" style="padding-right: 10px;"></span>';
        else     html += '<span class="glyphicon glyphicon-chevron-right" style="padding-right: 10px;"></span>';
        html+= '<a style="color: #428bca; cursor:pointer;" onclick="getLogins()"> Login Report</a>' +
        '</a>' +
        '</h4>' +
        '</div>';
        if(result.length==0) html+= '<div id="collapse'+result.length+'" class="panel-collapse collapse in">';
        else     html += '<div id="collapse'+result.length+'" class="panel-collapse collapse">';
        html += '<div class="panel-body" style="padding-left: 45px;">Shows the last login date for the users that you manage.</div>' +
        '</div>' +
        '</div>';
      } else {

      }
      document.getElementById("reportsPanel").innerHTML = html;
    }

  }, {escape:true});

}

function getLogins(){
  document.getElementById("lastLoginNumberOnPanel").innerHTML = '<i class="fa fa-refresh fa-spin fa-1x fa-fw" aria-hidden="true" id="refreshLastLogin"></i>';
  document.getElementById("lastLoginTableBody").innerHTML = '';
  $("#reports").hide();
  $("#goBackButton").hide();
  $("#lastLogin").show();
  $("#lastLoginBackButton").show();
  SALES_LaunchpadController.getLogins('{!$User.Id}', '{!$UserRole.Id}', function(result, event){
    var obj = JSON.parse(result);
    if(obj.count>0){
      document.getElementById("lastLoginTableBody").innerHTML = obj.html;
      $.bootstrapSortable(true);
      $("#lastLoginAlert").hide();
      $("#lastLoginPanel").show();
    } else{
      $("#lastLoginAlert").show();
      $("#lastLoginPanel").hide();
    }
    document.getElementById("lastLoginNumberOnPanel").innerHTML = obj.count;
  }, {escape:false});
}

function lastLoginGoBack(){
  $("#lastLogin").hide();
  $("#lastLoginBackButton").hide();
  $("#reports").show();
  $("#goBackButton").show();
}

var alfaClassification = 'All';
var numClassification = 'All';
var searchClassification = '';
var searchOption = '';

$('#searchClassification').keyup(function(event) {
  if($('#searchClassification').val() != searchClassification) {
    $('#searchClassificationSpinner').show();
  }
  searchClassification = $('#searchClassification').val();
});

function radioCheck(){
  if (document.getElementById("HHradio").checked){
    searchOption = 'HH';
    document.getElementById("priorTH").innerHTML = "PY";
    document.getElementById("currentTH").innerHTML = "YTD";
    document.getElementById("lastCalledSubTitle").innerHTML = "Home Health by Year";
  } else if (document.getElementById("HPradio").checked){
    searchOption = 'HP';
    document.getElementById("priorTH").innerHTML = "PY";
    document.getElementById("currentTH").innerHTML = "YTD";
    document.getElementById("lastCalledSubTitle").innerHTML = "Hospice by Year";
  } else if (document.getElementById("HHMTDradio").checked){
    searchOption = 'HHMTD';
    document.getElementById("priorTH").innerHTML = "PM";
    document.getElementById("currentTH").innerHTML = "MTD";
    document.getElementById("lastCalledSubTitle").innerHTML = "Home Health by Month";
  } else if (document.getElementById("HPMTDradio").checked){
    searchOption = 'HPMTD';
    document.getElementById("priorTH").innerHTML = "PM";
    document.getElementById("currentTH").innerHTML = "MTD";
    document.getElementById("lastCalledSubTitle").innerHTML = "Hospice by Month";
  } else if (document.getElementById("KHRSMTDradio").checked){
    searchOption = 'KHRSMTD';
    document.getElementById("priorTH").innerHTML = "PM";
    document.getElementById("currentTH").innerHTML = "MTD";
    document.getElementById("lastCalledSubTitle").innerHTML = "Outpatient by Month";
  } else if (document.getElementById("HHYOYradio").checked){
    searchOption = 'HHYOY';
    document.getElementById("priorTH").innerHTML = "PY";
    document.getElementById("currentTH").innerHTML = "MTD";
    document.getElementById("lastCalledSubTitle").innerHTML = "Home Health by Month/Year Over Year";
  }  else if (document.getElementById("HPYOYradio").checked){
    searchOption = 'HPYOY';
    document.getElementById("priorTH").innerHTML = "PY";
    document.getElementById("currentTH").innerHTML = "MTD";
    document.getElementById("lastCalledSubTitle").innerHTML = "Hospice by Month/Year Over Year";
  }  else if (document.getElementById("KHRSYOYradio").checked){
    searchOption = 'KHRSYOY';
    document.getElementById("priorTH").innerHTML = "PY";
    document.getElementById("currentTH").innerHTML = "MTD";
    document.getElementById("lastCalledSubTitle").innerHTML = "Outpatient by Month/Year Over Year";
  } else {
    if ('{!$Profile.Name}'.indexOf('KAH')>=0){
      if('{!$User.Title}'.indexOf('Hospice')>=0){
        $("#HPradio").prop("checked", true);
        searchOption = 'HP';
        document.getElementById("priorTH").innerHTML = "HP PY";
        document.getElementById("currentTH").innerHTML = "HP YTD";
        document.getElementById("lastCalledSubTitle").innerHTML = "Hospice by Year";
      } else {
        $("#HHradio").prop("checked", true);
        searchOption = 'HH';
        document.getElementById("priorTH").innerHTML = "HH PY";
        document.getElementById("currentTH").innerHTML = "HH YTD";
        document.getElementById("lastCalledSubTitle").innerHTML = "Home Health by Year";
      }
    } else if('{!$Profile.Name}'.indexOf('KHRS')>=0){
      $("#KHRSMTDradio").prop("checked", true);
      searchOption = 'KHRSMTD';
      document.getElementById("priorTH").innerHTML = "PM";
      document.getElementById("currentTH").innerHTML = "MTD";
      document.getElementById("lastCalledSubTitle").innerHTML = "Outpatient by Month";
    }
  }
}

var usrId = '{!$User.Id}';
function getLastActivityByClassification(){

  SALES_LaunchpadController.getLastActivityByClassification(usrId, alfaClassification, numClassification, searchClassification, searchOption, function(result, event){
    if (result != ''){
      $("#lastActivityByClassificationAlert").fadeOut('400');
      $("#lastActivityByClassificationPanel").show();
      document.getElementById("lastActivityByClassificationTableBody").innerHTML = result;
      $.bootstrapSortable(true);

      $('#lastActivityByClassificationNumberOnPanel').html((result.match(/<tr>/g) || []).length);
      $('#lastCalledReferralSourcesNumber').html((result.match(/<tr>/g) || []).length);

    } else{
      $("#lastActivityByClassificationPanel").hide();
      $("#lastActivityByClassificationAlert").fadeIn('400');
      $('#lastActivityByClassificationNumberOnPanel').html(0);
      $('#lastCalledReferralSourcesNumber').html(0);

    }
  }, {escape:false});
  $('#alfaClassSpan').html(alfaClassification +' <i class="fa fa-chevron-circle-down" aria-hidden="true" id="alfaClass"></i>');
  $('#numClassSpan').html(numClassification +' <i class="fa fa-chevron-circle-down" aria-hidden="true" id="numClass"></i>');
  $('#searchClassificationSpinner').hide();
  $("#drilldownSpinner").removeClass().addClass('fa fa-chevron-circle-down');
}

function emailReport(){
  var lastActivityTableContents = '';

  if (searchOption == 'HH'){
    lastActivityTableContents = 'My Assignments, ';
    lastActivityTableContents += "Home Health by Year \n";
    lastActivityTableContents += "Name, YTD, PY, ";
  } else if (searchOption == 'HP'){
    lastActivityTableContents = 'My Assignments, ';
    lastActivityTableContents += "Hospice by Year \n";
    lastActivityTableContents += "Name, YTD, PY, ";
  } else if (searchOption == 'HHMTD'){
    lastActivityTableContents = 'My Assignments, ';
    lastActivityTableContents += "Home Health by Month \n";
    lastActivityTableContents += "Name, MTD, PM, ";
  } else if (searchOption == 'HPMTD'){
    lastActivityTableContents = 'My Assignments, ';
    lastActivityTableContents += "Hospice by Month \n";
    lastActivityTableContents += "Name, MTD, PM, ";
  } else if (searchOption == 'KHRSMTD'){
    lastActivityTableContents = 'My Assignments, ';
    lastActivityTableContents += "Outpatient by Month \n";
    lastActivityTableContents += "Name, MTD, PM, ";
  } else if (searchOption == 'KHRSYOY'){
    lastActivityTableContents = 'My Assignments, ';
    lastActivityTableContents += "Outpatient by Month/Year Over Year \n";
    lastActivityTableContents += "Name, MTD, PY, ";
  } else if (searchOption == 'HHYOY'){
    lastActivityTableContents = 'My Assignments, ';
    lastActivityTableContents += "Home Health by Month/Year Over Year \n";
    lastActivityTableContents += "Name, MTD, PY, ";
  } else if (searchOption == 'HPYOY'){
    lastActivityTableContents = 'My Assignments, ';
    lastActivityTableContents += "Hospice by Month/Year Over Year \n";
    lastActivityTableContents += "Name, MTD, PY, ";
  }

  lastActivityTableContents += 'AC, Last Called \n';

  $('#lastActivityByClassificationTable tr:gt(0)').each(function(row, tr){
    lastActivityTableContents += '"'+$(tr).find('td:eq(0)').text() + '", '
    + $(tr).find('td:eq(1)').text() + ', '
    + $(tr).find('td:eq(2)').text() + ', '
    + $(tr).find('td:eq(3)').text() + ', '
    + $(tr).find('td:eq(4)').text() + ' '
    + '\n';
  });

  SALES_LaunchpadController.emailLastActivityByClassification(usrId, lastActivityTableContents, function(result, event){
    $("#emailAlert").fadeIn('400');
    setTimeout(function() { $("#emailAlert").fadeOut('400'); }, 4000);
  }, {escape:true});
}

function getUsersUnderRole(){
  SALES_LaunchpadController.getUsersUnderRoleId('{!$UserRole.Id}', function(result, event){
    if(result != ''){
      document.getElementById("usersUnderRoleTableBody").innerHTML = result;
      $roleRows = $('#usersUnderRoleTable tbody tr');
    }
  }, {escape:false});
}

var $roleRows;
$('#usersUnderRoleTableSearch').keyup(function() {
  var val = $.trim($(this).val()).replace(/ +/g, ' ').toLowerCase();

  $roleRows.show().filter(function() {
    var text = $(this).text().replace(/\s+/g, ' ').toLowerCase();
    return !~text.indexOf(val);
  }).hide();
});

var roleNav = [];
var currentRole = '{!$UserRole.Id}';
function revertOneRole(){
  if(roleNav.length > 0){
    currentRole = roleNav.pop();
    getRoles(currentRole);
  }
}

function getRoles(role){
  SALES_LaunchpadController.getUsersByRole(role, function(result, event){
    if(result != ''){
      document.getElementById("roleHierarchy").innerHTML = result;
    }
  }, {escape:false});
}


var recordType = null;
SALES_LaunchpadController.getRecordType('Sales: KAH Event', function(result, event){

  if (result.length != 0){
    recordType = result[0].Id;
  }
}, {escape:true});

function addCommas(nStr){
  nStr += '';
  x = nStr.split('.');
  x1 = x[0];
  x2 = x.length > 1 ? '.' + x[1] : '';
  var rgx = /(\d+)(\d{3})/;
  while (rgx.test(x1)) {
    x1 = x1.replace(rgx, '$1' + ',' + '$2');
  }
  return x1 + x2;
}

function navigateTo(id, type){
  if(type == 'view'){
    if( (typeof sforce != 'undefined') && sforce && (!!sforce.one) ) {
      $("#page").hide();
      sforce.one.navigateToSObject(id);
      setTimeout(function(){ $("#page").show(); }, 500);
    } else {
      var targetHPandRevenue = '/'+id;
      window.open(targetHPandRevenue);
    }
  } else if (type == 'createEvent'){
    if( (typeof sforce != 'undefined') && sforce && (!!sforce.one) ) {
      $("#page").hide();
      if(recordType != null) sforce.one.createRecord('Event', recordType);
      else sforce.one.createRecord('Event');
      setTimeout(function(){ $("#page").show(); }, 500);
    } else {
      var targetHPandRevenue = '/00U/e';
      window.open(targetHPandRevenue);
    }
  }  else if (type == 'report'){
    if( (typeof sforce != 'undefined') && sforce && (!!sforce.one) ) {
      $("#page").hide();
      var target = '/'+id+'?isdtp=p1';
      window.open("{!LEFT($CurrentPage.URL,FIND('/',$CurrentPage.URL,9))}"+target);
      setTimeout(function(){ $("#page").show(); }, 500);
    } else {
      var target = '/'+id;
      window.open("{!LEFT($CurrentPage.URL,FIND('/',$CurrentPage.URL,9))}"+target);
    }
  } else if (type == 'calendar'){
    if( (typeof sforce != 'undefined') && sforce && (!!sforce.one) ) {
      $("#page").hide();
      var target = '/00U/c?isdtp=vw';
      window.open("{!LEFT($CurrentPage.URL,FIND('/',$CurrentPage.URL,9))}"+target);
      setTimeout(function(){ $("#page").show(); }, 500);

      setTimeout(function(){ $("#page").show(); }, 500);
    } else {
      var target = '/00U/c';
      window.open("{!LEFT($CurrentPage.URL,FIND('/',$CurrentPage.URL,9))}"+target);
    }
  }
}

function marketingTool(){
  if( (typeof sforce != 'undefined') && sforce && (!!sforce.one) ) {
    $("#page").hide();
    sforce.one.navigateToURL("{!LEFT($CurrentPage.URL,FIND('/',$CurrentPage.URL,9))}"+'/apex/Sales_MarketingToolAlpha');
    setTimeout(function(){ $("#page").show(); }, 500);
  } else {
    window.open("{!LEFT($CurrentPage.URL,FIND('/',$CurrentPage.URL,9))}"+'/apex/Sales_MarketingToolAlpha');
  }
}
</script>
</apex:page>